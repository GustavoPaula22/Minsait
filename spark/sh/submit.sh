cd /home/gustavo.pasilva@sefaz.go.gov.br/IPM_PROJETO/Projeto_Djang_in_Spark

zip -r /tmp/projeto_djang_in_spark.zip app  

env -u PYSPARK_DRIVER_PYTHON -u PYSPARK_DRIVER_PYTHON_OPTS spark-submit   --master yarn   --deploy-mode client   --name "PROCESSO_CARGA_NFE_IPM"   --num-executors 8   --executor-cores 4   --executor-memory 10g   --driver-cores 2   --driver-memory 8g   --conf spark.driver.maxResultSize=4g   --conf spark.dynamicAllocation.enabled=false   --conf spark.sql.shuffle.partitions=400   --conf spark.sql.session.timeZone=America/Sao_Paulo   --packages org.apache.kudu:kudu-spark3_2.12:1.16.0,org.apache.iceberg:iceberg-spark-runtime-3.3_2.12:1.6.1,com.oracle.database.jdbc:ojdbc8:21.11.0.0   --archives hdfs:///user/gustavo.pasilva/ipm_env.zip#environment   --py-files /tmp/projeto_djang_in_spark.zip   --conf spark.pyspark.driver.python=/usr/bin/python3   --conf spark.pyspark.python=environment/bin/python   --conf spark.executorEnv.PYSPARK_PYTHON=environment/bin/python   --conf "spark.driverEnv.ORA_DNS=(DESCRIPTION=(ADDRESS_LIST=(FAILOVER=ON)(LOAD_BALANCE=OFF)(ADDRESS=(PROTOCOL=TCP)(HOST=exa03vm01-scan.intra.goias.gov.br)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=exa04-scan01.intra.goias.gov.br)(PORT=1521)))(CONNECT_DATA=(SERVER=SHARED)(SERVICE_NAME=prodadg)))"   --conf "spark.executorEnv.ORA_DNS=(DESCRIPTION=(ADDRESS_LIST=(FAILOVER=ON)(LOAD_BALANCE=OFF)(ADDRESS=(PROTOCOL=TCP)(HOST=exa03vm01-scan.intra.goias.gov.br)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=exa04-scan01.intra.goias.gov.br)(PORT=1521)))(CONNECT_DATA=(SERVER=SHARED)(SERVICE_NAME=prodadg)))"   --conf "spark.yarn.appMasterEnv.ORA_DNS=(DESCRIPTION=(ADDRESS_LIST=(FAILOVER=ON)(LOAD_BALANCE=OFF)(ADDRESS=(PROTOCOL=TCP)(HOST=exa03vm01-scan.intra.goias.gov.br)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=exa04-scan01.intra.goias.gov.br)(PORT=1521)))(CONNECT_DATA=(SERVER=SHARED)(SERVICE_NAME=prodadg)))"   --conf "spark.driverEnv.IPM_ORACLE_DSN=(DESCRIPTION=(ADDRESS_LIST=(FAILOVER=ON)(LOAD_BALANCE=OFF)(ADDRESS=(PROTOCOL=TCP)(HOST=exa03vm01-scan.intra.goias.gov.br)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=exa04-scan01.intra.goias.gov.br)(PORT=1521)))(CONNECT_DATA=(SERVER=SHARED)(SERVICE_NAME=prodadg)))"   --conf "spark.executorEnv.IPM_ORACLE_DSN=(DESCRIPTION=(ADDRESS_LIST=(FAILOVER=ON)(LOAD_BALANCE=OFF)(ADDRESS=(PROTOCOL=TCP)(HOST=exa03vm01-scan.intra.goias.gov.br)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=exa04-scan01.intra.goias.gov.br)(PORT=1521)))(CONNECT_DATA=(SERVER=SHARED)(SERVICE_NAME=prodadg)))"   --conf "spark.yarn.appMasterEnv.IPM_ORACLE_DSN=(DESCRIPTION=(ADDRESS_LIST=(FAILOVER=ON)(LOAD_BALANCE=OFF)(ADDRESS=(PROTOCOL=TCP)(HOST=exa03vm01-scan.intra.goias.gov.br)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=exa04-scan01.intra.goias.gov.br)(PORT=1521)))(CONNECT_DATA=(SERVER=SHARED)(SERVICE_NAME=prodadg)))"   "/home/gustavo.pasilva@sefaz.go.gov.br/IPM_PROJETO/Projeto_Djang_in_Spark/app/main.py"   --document nfe   --data-inicio 2024-01-01   --data-fim 2024-01-01   --dt-inicio "2024-01-01 00:00:00"   --dt-fim    "2024-01-01 23:59:59"   --print-settings true   --truncate-iceberg   --no-audit --prefer-day-partition true
